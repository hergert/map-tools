/* map-tools.js 1.0.1 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function t(n,r,o){function e(i,s){if(!r[i]){if(!n[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var c=r[i]={exports:{}};n[i][0].call(c.exports,function(t){var r=n[i][1][t];return e(r?r:t)},c,c.exports,t,n,r,o)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)e(o[i]);return e}({1:[function(t){"use strict";window.mapTools=t("map-tools/index")(window)},{"map-tools/index":13}],2:[function(t,n){"use strict";var r=t("topojson"),o=t("map-tools/utils");n.exports=function(n,e){function a(t,r){var a,i;for(i in t)if(t.hasOwnProperty(i)){a=t[i];var s=a.k;a.k.uid=o.createUid(),Object.defineProperty(a,"data",{value:s,enumerable:!0,writable:!1,configurable:!1}),r&&(r.filters&&(n.mapTools.maps[e.id].json.filter||u("json",r.filters),n.mapTools.maps[e.id].json.crossfilter.add([a.data])),r.style&&e.instance.data.overrideStyle(a,r.style)),n.mapTools.maps[e.id].json.all[a.data.uid]=a}}function i(t,o){var i,s,u,f;for(f in o)o.hasOwnProperty(f)&&(i=o[f],s=r.feature(t,t.objects[i.object]),u=e.instance.data.addGeoJson(s),a(u,i),n.mapTools.maps[e.id].json.groups[i.object]=u);return u}function s(t,n){var r=e.instance.data.addGeoJson(t,n);return a(r,n),r}var u=t("map-tools/addFilter")(n,e);return{addGeoJson:s,addTopoJson:i}}},{"map-tools/addFilter":3,"map-tools/utils":21,topojson:24}],3:[function(t,n){var r=t("crossfilter");n.exports=function(t,n){function o(t){return function(n){return n[t]}}function e(e,a){t.mapTools.maps[n.id][e].crossfilter=t.mapTools.maps[n.id][e].crossfilter||r([]),t.mapTools.maps[n.id][e].filter=t.mapTools.maps[n.id][e].filter||{};var i,s;"string"==typeof a&&(a=[a]);for(i in a)a.hasOwnProperty(i)&&(s=a[i],"string"==typeof s?t.mapTools.maps[n.id][e].filter[s]=t.mapTools.maps[n.id][e].crossfilter.dimension(o(s)):t.mapTools.maps[n.id][e].filter[Object.keys(s)[0]]=t.mapTools.maps[n.id][e].crossfilter.dimension(s[Object.keys(s)[0]]))}return e}},{crossfilter:23}],4:[function(t,n){"use strict";var r=t("map-tools/config");n.exports=function(n,o){function e(t){return t.el?n.document.querySelector(t.el):t.id?n.document.getElementById(t.id):void 0}function a(t,a){a=a||function(){};var i=u.mapOptions(t);if(t.id=t.id||t.el.substring(1),o.id=t.id,o.options=t,o.instance=new n.google.maps.Map(e(t),i),o.events=[],t.on){var s;for(s in t.on)t.on.hasOwnProperty(s)&&(r.customEvents.indexOf(s)>-1&&o.events.push(s),n.google.maps.event.addListener(o.instance,s,t.on[s]))}o.infoWindow=!1,o.templates={infoWindow:{},panel:{}},o.uid=t.uid,n.mapTools.maps[o.id].instance=o.instance,n.google.maps.event.addListenerOnce(o.instance,"idle",function(){a(!1,o)})}function i(t,n){return!t||t&&"object"!=typeof t?(n(new Error("You must pass a valid first parameter: options")),!1):t.id||t.el?t.lat&&t.lng?!0:(n(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(n(new Error('You must pass an "id" or a "el" property values')),!1)}function s(t,r){if(i(t,r)){var e=t.id||t.el.substring(1);if(n.mapTools.maps=n.mapTools.maps||{},n.mapTools.maps[e]);n.mapTools.maps[e]={create:function(){a(this.arguments,r)},arguments:t},n.mapTools.maps[e].markers=n.mapTools.maps[e].markers||{},n.mapTools.maps[e].json=n.mapTools.maps[e].json||{all:{},groups:{}},o.markers=n.mapTools.maps[e].markers,o.json=n.mapTools.maps[e].json,t.async!==!1||t.sync===!0?u.load(e,t):n.mapTools.maps[e].create()}}var u=t("map-tools/gmaps.js")(n);return{load:s}}},{"map-tools/config":8,"map-tools/gmaps.js":11}],5:[function(t,n){"use strict";var r=t("map-tools/utils");n.exports=function(n,o){function e(t,e){var s,c;t.map=o.instance,t.position=new n.google.maps.LatLng(t.lat,t.lng);var l=t.group||!1;if(e&&e.group&&(l=e.group||l),e)for(s in e)e.hasOwnProperty(s)&&(e.filters||(t[s]=e[s]));if(t.data=t.data||{},t.data._self=t,l&&o.markers&&o.markers.groupOptions&&o.markers.groupOptions[l])for(c in o.markers.groupOptions[l])o.markers.groupOptions[l].hasOwnProperty(c)&&(t[c]=o.markers.groupOptions[l][c]);o.uid&&t[o.uid]&&(t.data.uid=t[o.uid]),t.data.uid||(t.data.uid=r.createUid()),e&&e.filters&&(n.mapTools.maps[o.id].markers.filter||f("markers",e.filters),o.markers.crossfilter.add([t.data]));var p=new n.google.maps.Marker(t);return t.move&&p.setAnimation(n.google.maps.Animation[t.move.toUpperCase()]),t.infoWindow&&u.addEvents(p,t.infoWindow,o.instance),t.on&&a(t,p),l&&i(l,p),o.markers.all=n.mapTools.maps[o.id].markers.all||{},o.markers.all[t.data.uid]=p,p}function a(t,r){var o;for(o in t.on)t.on.hasOwnProperty(o)&&n.google.maps.event.addListener(r,o,t.on[o])}function i(t,r){o.markers.groups=n.mapTools.maps[o.id].markers.groups||{},o.markers.groups[t]=n.mapTools.maps[o.id].markers.groups[t]||[],o.markers.groups[t].push(r)}function s(t,n){if(r.isArray(t)){if(t.length>=1){var o,a=[];for(var i in t)t.hasOwnProperty(i)&&(o=e(t[i],n),a.push(o));return a}return[]}return e(t,n)}var u=t("map-tools/infoWindow")(n,o),f=t("map-tools/addFilter")(n,o);return s}},{"map-tools/addFilter":3,"map-tools/infoWindow":14,"map-tools/utils":21}],6:[function(t,n){"use strict";var r=t("map-tools/config");n.exports=function(n,o){function e(t){return t.toUpperCase().match(/\S+/g).join("_")}function a(t){return t.replace(/-(.)/g,function(t,n){return n.toUpperCase()})}function i(t){var n=window.document.createElement("div");return n.innerHTML=t,n}function s(t,s){function f(){if(t.position&&(t.position=e(t.position),c=n.google.maps.ControlPosition[t.position]),"object"==typeof t.style)for(m in t.style)if(t.style.hasOwnProperty(m)){var r=a(m);l.style[r]=t.style[m]}if(t.events)for(p in t.events)if(t.events.hasOwnProperty(p)){var i=p.match(/\S+/g),u=i.splice(-1),f=i.join(" "),d=l.querySelectorAll(f);[].forEach.call(d,function(r){n.google.maps.event.addDomListener(r,u,t.events[p])})}o.instance.controls[c].push(l),o.panels=o.panels||{},o.panels[c]=l,s(!1,l)}s=s||function(){};var c,l,p,m;return t.position=t.position||r.panelPosition,t.templateURL?void u("panel",t.templateURL,function(t,n){return t?void s(t):(l=i(n),f())}):(l="string"==typeof t.template?i(t.template):t.template,f())}var u=t("map-tools/template")(n,o);return s}},{"map-tools/config":8,"map-tools/template":17}],7:[function(t,n){"use strict";n.exports=function(t,n){function r(r,o){var e;e=r&&o?new t.google.maps.LatLng(r,o):new t.google.maps.LatLng(n.options.lat,n.options.lng),n.instance.setCenter(e)}return r}},{}],8:[function(t,n){"use strict";n.exports={version:"3.18",url:"//maps.googleapis.com/maps/api/js",zoom:8,customMapOptions:["id","lat","lng","type","uid"],customMarkerOptions:["lat","lng","move","infoWindow","on"],panelPosition:"TOP_LEFT",customInfoWindowOptions:["open","close"],customEvents:["marker_visibility_changed"]}},{}],9:[function(t,n){n.exports=function(t,n,r){function o(t,o){var a,i,s,u,f;return"string"==typeof t?a=t:(a=Object.keys(t)[0],u=t[a]),n[r].filter[a]?(i=o&&o.order&&e[o.order]?e[o.order]:e[Object.keys(e)[0]],s=o&&o.limit?o.limit:1/0,u=u||null,f=n[r].filter[a].filter(u)[i](s),1===s?f[0]:f):!1}var e={ASC:"top",DESC:"bottom"};return o}},{}],10:[function(t,n){"use strict";n.exports=function(t,n){function r(r){return r.data&&r.data.uid?r:r.uid&&t.mapTools.maps[n.id].markers.all[r.uid]?t.mapTools.maps[n.id].markers.all[r.uid]:void 0}return r}},{}],11:[function(t,n){"use strict";var r=t("map-tools/config"),o=t("map-tools/utils");n.exports=function(t){function n(n,o){var e=o.version||r.version,a=t.document.createElement("script");return a.type="text/javascript",a.src=r.url+"?v="+e+"&callback=mapTools.maps."+n+".create",t.document.body.appendChild(a)}function e(n){var e=o.clone(n,r.customMapOptions);return e.zoom=n.zoom||r.zoom,n.lat&&n.lng&&(e.center=new t.google.maps.LatLng(n.lat,n.lng)),n.type&&(e.mapTypeId=t.google.maps.MapTypeId[n.type]||!1),e}return{load:n,mapOptions:e}}},{"map-tools/config":8,"map-tools/utils":21}],12:[function(t,n){"use strict";var r=t("map-tools/utils"),o=t("map-tools/config");n.exports=function(n,e){function a(t,r){n.mapTools.maps[e.id].markers=n.mapTools.maps[e.id].markers||{},n.mapTools.maps[e.id].markers.groups=n.mapTools.maps[e.id].markers.groups||[],n.mapTools.maps[e.id].markers.groupOptions=n.mapTools.maps[e.id].markers.groupOptions||{},n.mapTools.maps[e.id].markers.groupOptions[t]=r}function i(t,a){var i,u,f=[],c=r.prepareOptions(a,o.customMarkerOptions);if(n.mapTools.maps[e.id].markers.groups&&n.mapTools.maps[e.id].markers.groups[t])for(u in n.mapTools.maps[e.id].markers.groups[t])n.mapTools.maps[e.id].markers.groups[t].hasOwnProperty(u)&&(i=s.customUpdate(n.mapTools.maps[e.id].markers.groups[t][u],c),f.push(i));return f}var s=t("map-tools/updateMarker")(n,e);return{addGroup:a,updateGroup:i}}},{"map-tools/config":8,"map-tools/updateMarker":20,"map-tools/utils":21}],13:[function(t,n){"use strict";n.exports=function(n){function r(r,o){var e=this;this.addMarker=t("map-tools/addMarker")(n,e),this.removeMarker=t("map-tools/removeMarker")(n,e),this.resetMarker=t("map-tools/resetMarker")(n,e),this.addTopoJson=t("map-tools/addFeature")(n,e).addTopoJson,this.addGeoJson=t("map-tools/addFeature")(n,e).addGeoJson,this.updateFeature=t("map-tools/updateFeature")(n,e),this.addPanel=t("map-tools/addPanel")(n,e),this.updateMarker=t("map-tools/updateMarker")(n,e).update,this.filterFeature=t("map-tools/filter")(n,e,"json"),this.findMarker=t("map-tools/filter")(n,e,"markers"),this.addGroup=t("map-tools/groups")(n,e).addGroup,this.updateGroup=t("map-tools/groups")(n,e).updateGroup,this.updateMap=t("map-tools/updateMap")(n,e),this.center=t("map-tools/center")(n,e),this.zoom=function(t){return"undefined"==typeof t?e.instance.getZoom():void e.instance.setZoom(t)},this.locate=function(){var t=e.instance.getCenter();return{lat:t.lat(),lng:t.lng()}};var a=t("map-tools/addMap")(n,e);return n.onload=a.load(r,o),this}return r.prototype.instance=!1,r}},{"map-tools/addFeature":2,"map-tools/addMap":4,"map-tools/addMarker":5,"map-tools/addPanel":6,"map-tools/center":7,"map-tools/filter":9,"map-tools/groups":12,"map-tools/removeMarker":15,"map-tools/resetMarker":16,"map-tools/updateFeature":18,"map-tools/updateMap":19,"map-tools/updateMarker":20}],14:[function(t,n){"use strict";var r=t("map-tools/utils"),o=t("map-tools/config");n.exports=function(t,n){function e(o,e,a){var i=!1;e.infoWindow.content&&(e.infoWindow.content.indexOf("{")>-1&&(i=a.content.replace(/\{(\w+)\}/g,function(t,n){return e.data[n]||""})),i=i||e.infoWindow.content);var s=r.clone(a);s.content=i,n.infoWindow=new t.google.maps.InfoWindow(s),n.infoWindow.open(o,e)}function a(t,n,r){s(),e(t,n,r)}function i(t){var n=t.getMap();return null!==n&&"undefined"!=typeof n}function s(){clearTimeout(f),n.infoWindow&&i(n.infoWindow)&&n.infoWindow.close()}function u(e,u,c){var l=r.prepareOptions(u,o.customInfoWindowOptions),p=l.custom&&l.custom.open&&l.custom.open.on?l.custom.open.on:"click",m=l.custom&&l.custom.close&&l.custom.close.on?l.custom.close.on:"click";p===m?t.google.maps.event.addListener(e,p,function(){n.infoWindow&&i(n.infoWindow)?s():a(c,e,l.defaults)}):(t.google.maps.event.addListener(e,p,function(){a(c,e,l.defaults)}),t.google.maps.event.addListener(e,m,function(){l.custom.close.duration?f=setTimeout(function(){s()},l.custom.close.duration):s()}))}var f=!1;return{addEvents:u}}},{"map-tools/config":8,"map-tools/utils":21}],15:[function(t,n){"use strict";n.exports=function(n,r){function o(t){var n,r;for(r in t)t.hasOwnProperty(r)&&(n=t[r],a(i(n)))}function e(t){"undefined"==typeof t&&o(r.markers.all);var n=Object.prototype.toString.call(t);return"[object Object]"===n?a(i(t)):void("[object Array]"===n&&o(t))}function a(t){t.setMap(null),delete n.mapTools.maps[r.id].markers.all[t.data.uid]}var i=t("map-tools/findMarker")(n,r);return e}},{"map-tools/findMarker":10}],16:[function(t,n){"use strict";var r=t("map-tools/utils"),o=t("map-tools/config");n.exports=function(n,e){function a(t,n){var r;for(r in t)u(t[r],n)}function i(t,n){var r=Object.prototype.toString.call(t);return"[object Object]"===r?u(f(t),n):"[object Array]"===r?a(t,n):void 0}function s(t,n){var r,o={},e=Object.prototype.toString.call(n);if("[object String]"===e&&(o[n]=t.data._self[n]),"[object Array]"===e)for(r in n)o[n[r]]=t.data._self[n[r]];return o}function u(t,n){var e=r.prepareOptions(s(t,n),o.customMarkerOptions);return c.customUpdate(t,e),t}var f=t("map-tools/findMarker")(n,e),c=t("map-tools/updateMarker")(n,e);return i}},{"map-tools/config":8,"map-tools/findMarker":10,"map-tools/updateMarker":20,"map-tools/utils":21}],17:[function(t,n){"use strict";n.exports=function(t,n){function r(t,r,o){if(n.templates[t][r])return n.templates[t][r];var e=new XMLHttpRequest;e.open("GET",r),e.onload=function(){4===e.readyState&&(200===e.status?(n.templates[t][r]=e.responseText,o(!1,e.responseText)):o(new Error(e.statusText)))},e.onerror=function(){o(new Error(e.statusText))},e.send(null)}return r}},{}],18:[function(t,n){"use strict";n.exports=function(t,n){function r(t,r){if("function"==typeof r){var o=r.call(t);return n.instance.data.overrideStyle(t,o)}n.instance.data.overrideStyle(t,r)}function o(t,n){var r=Object.prototype.toString.call(t);if("[object Array]"===r){var o,a;for(a in t)t.hasOwnProperty(a)&&(o=t[a],e(o,n))}"[object Object]"===r&&e(t,n)}function e(r,o){return r.data&&r.data.uid?a(r,o):r.uid&&t.mapTools.maps[n.id].json&&t.mapTools.maps[n.id].json.all[r.uid]?a(t.mapTools.maps[n.id].json.all[r.uid],o):void 0}function a(t,n){n.style&&r(t,n.style)}return o}},{}],19:[function(t,n){"use strict";n.exports=function(n,r){function o(t){var n=e.mapOptions(t);return r.instance.setOptions(n)}var e=t("map-tools/gmaps.js")(n);return o}},{"map-tools/gmaps.js":11}],20:[function(t,n){"use strict";var r=t("map-tools/utils"),o=t("map-tools/config");n.exports=function(n,e){function a(t,n){var a=!1,f=Object.prototype.toString.call(t),c=r.prepareOptions(n,o.customMarkerOptions);c.defaults&&c.defaults.hasOwnProperty("visible")&&e.events.indexOf("marker_visibility_changed")>-1&&(a=!0);var l;if("[object Object]"===f&&(l=s(u(t),c)),"[object Array]"===f){var p,m,d,v=[];for(d in t)t.hasOwnProperty(d)&&(p=t[d],m=s(u(p),c),v.push(m));l=v}return a&&i(),l}function i(){var t,r=0;for(t in e.markers.all)e.markers.all[t].visible&&r++;n.google.maps.event.trigger(e.instance,"marker_visibility_changed",r)}function s(t,r){return r.custom&&(r.custom.move&&t.setAnimation(n.google.maps.Animation[r.custom.move.toUpperCase()]),r.custom.lat&&r.custom.lng&&t.setPosition(new n.google.maps.LatLng(r.custom.lat,r.custom.lng)),r.custom.infoWindow&&r.custom.infoWindow.content&&(t.infoWindow.content=r.custom.infoWindow.content)),r.defaults&&t.setOptions(r.defaults),t}var u=t("map-tools/findMarker")(n,e);return{update:a,customUpdate:s}}},{"map-tools/config":8,"map-tools/findMarker":10,"map-tools/utils":21}],21:[function(t,n){"use strict";function r(t,n){var o,e,a;o=Array.isArray(t)?[]:{};for(a in t)t.hasOwnProperty(a)&&(!n||n&&-1===n.indexOf(a))&&(e=t[a],o[a]="object"==typeof e?r(e):e);return o}function o(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n,r;return n=16*Math.random()|0,r="x"===t?n:3&n|8,r.toString(16)})}function e(t,n){var r,o={};for(r in t)t.hasOwnProperty(r)&&(n.indexOf(r)>-1?(o.custom=o.custom||{},o.custom[r]=t[r]):(o.defaults=o.defaults||{},o.defaults[r]=t[r]));return o}function a(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}n.exports={clone:r,createUid:o,prepareOptions:e,isArray:a}},{}],22:[function(t,n,r){!function(t){function n(t){return t}function r(t,n){for(var r=0,o=n.length,e=new Array(o);o>r;++r)e[r]=t[n[r]];return e}function o(t){function n(n,r,o,e){for(;e>o;){var a=o+e>>>1;t(n[a])<r?o=a+1:e=a}return o}function r(n,r,o,e){for(;e>o;){var a=o+e>>>1;r<t(n[a])?e=a:o=a+1}return o}return r.right=r,r.left=n,r}function e(t){function n(t,n,r){for(var e=r-n,a=(e>>>1)+1;--a>0;)o(t,a,e,n);return t}function r(t,n,r){for(var e,a=r-n;--a>0;)e=t[n],t[n]=t[n+a],t[n+a]=e,o(t,1,a,n);return t}function o(n,r,o,e){for(var a,i=n[--e+r],s=t(i);(a=r<<1)<=o&&(o>a&&t(n[e+a])>t(n[e+a+1])&&a++,!(s<=t(n[e+a])));)n[e+r]=n[e+a],r=a;n[e+r]=i}return n.sort=r,n}function a(t){function n(n,o,e,a){var i,s,u,f,c=new Array(a=Math.min(e-o,a));for(s=0;a>s;++s)c[s]=n[o++];if(r(c,0,a),e>o){i=t(c[0]);do(u=t(f=n[o])>i)&&(c[0]=f,i=t(r(c,0,a)[0]));while(++o<e)}return c}var r=e(t);return n}function i(t){function n(n,r,o){for(var e=r+1;o>e;++e){for(var a=e,i=n[e],s=t(i);a>r&&t(n[a-1])>s;--a)n[a]=n[a-1];n[a]=i}return n}return n}function s(t){function n(t,n,e){return(A>e-n?o:r)(t,n,e)}function r(r,o,e){var a,i=(e-o)/6|0,s=o+i,u=e-1-i,f=o+e-1>>1,c=f-i,l=f+i,p=r[s],m=t(p),d=r[c],v=t(d),g=r[f],h=t(g),y=r[l],k=t(y),x=r[u],w=t(x);m>v&&(a=p,p=d,d=a,a=m,m=v,v=a),k>w&&(a=y,y=x,x=a,a=k,k=w,w=a),m>h&&(a=p,p=g,g=a,a=m,m=h,h=a),v>h&&(a=d,d=g,g=a,a=v,v=h,h=a),m>k&&(a=p,p=y,y=a,a=m,m=k,k=a),h>k&&(a=g,g=y,y=a,a=h,h=k,k=a),v>w&&(a=d,d=x,x=a,a=v,v=w,w=a),v>h&&(a=d,d=g,g=a,a=v,v=h,h=a),k>w&&(a=y,y=x,x=a,a=k,k=w,w=a);var O=d,b=v,T=y,M=k;r[s]=p,r[c]=r[o],r[f]=g,r[l]=r[e-1],r[u]=x;var j=o+1,E=e-2,P=M>=b&&b>=M;if(P)for(var A=j;E>=A;++A){var L=r[A],S=t(L);if(b>S)A!==j&&(r[A]=r[j],r[j]=L),++j;else if(S>b)for(;;){var _=t(r[E]);{if(!(_>b)){if(b>_){r[A]=r[j],r[j++]=r[E],r[E--]=L;break}r[A]=r[E],r[E--]=L;break}E--}}}else for(var A=j;E>=A;A++){var L=r[A],S=t(L);if(b>S)A!==j&&(r[A]=r[j],r[j]=L),++j;else if(S>M)for(;;){var _=t(r[E]);{if(!(_>M)){b>_?(r[A]=r[j],r[j++]=r[E],r[E--]=L):(r[A]=r[E],r[E--]=L);break}if(E--,A>E)break}}}if(r[o]=r[j-1],r[j-1]=O,r[e-1]=r[E+1],r[E+1]=T,n(r,o,j-1),n(r,E+2,e),P)return r;if(s>j&&E>u){for(var W,_;(W=t(r[j]))<=b&&W>=b;)++j;for(;(_=t(r[E]))<=M&&_>=M;)--E;for(var A=j;E>=A;A++){var L=r[A],S=t(L);if(b>=S&&S>=b)A!==j&&(r[A]=r[j],r[j]=L),j++;else if(M>=S&&S>=M)for(;;){var _=t(r[E]);{if(!(M>=_&&_>=M)){b>_?(r[A]=r[j],r[j++]=r[E],r[E--]=L):(r[A]=r[E],r[E--]=L);break}if(E--,A>E)break}}}}return n(r,j,E+1)}var o=i(t);return n}function u(t){for(var n=new Array(t),r=-1;++r<t;)n[r]=0;return n}function f(t,n){for(var r=t.length;n>r;)t[r++]=0;return t}function c(t,n){if(n>32)throw new Error("invalid array width!");return t}function l(t,n){return function(r){var o=r.length;return[t.left(r,n,0,o),t.right(r,n,0,o)]}}function p(t,n){var r=n[0],o=n[1];return function(n){var e=n.length;return[t.left(n,r,0,e),t.left(n,o,0,e)]}}function m(t){return[0,t.length]}function d(){return null}function v(){return 0}function g(t){return t+1}function h(t){return t-1}function y(t){return function(n,r){return n+ +t(r)}}function k(t){return function(n,r){return n-t(r)}}function x(){function t(t){var n=M,r=t.length;return r&&(x=x.concat(t),P=W(P,M+=r),S.forEach(function(o){o(t,n,r)})),c}function o(){for(var t=w(M,M),n=[],r=0,o=0;M>r;++r)P[r]?t[r]=o++:n.push(r);A.forEach(function(t){t(0,[],n)}),_.forEach(function(n){n(t)});for(var e,r=0,o=0;M>r;++r)(e=P[r])&&(r!==o&&(P[o]=e,x[o]=x[r]),++o);for(x.length=o;M>o;)P[--M]=0}function i(t){function o(n,o,e){H=n.map(t),Z=V(O(e),0,e),H=r(H,Z);var a,i=$(H),s=i[0],u=i[1];if(B)for(a=0;e>a;++a)B(H[a],a)||(P[Z[a]+o]|=K);else{for(a=0;s>a;++a)P[Z[a]+o]|=K;for(a=u;e>a;++a)P[Z[a]+o]|=K}if(!o)return R=H,Y=Z,rn=s,void(on=u);var f=R,c=Y,l=0,p=0;for(R=new Array(M),Y=w(M,M),a=0;o>l&&e>p;++a)f[l]<H[p]?(R[a]=f[l],Y[a]=c[l++]):(R[a]=H[p],Y[a]=Z[p++]+o);for(;o>l;++l,++a)R[a]=f[l],Y[a]=c[l];for(;e>p;++p,++a)R[a]=H[p],Y[a]=Z[p]+o;i=$(R),rn=i[0],on=i[1]}function i(t,n,r){tn.forEach(function(t){t(H,Z,n,r)}),H=Z=null}function u(t){for(var n,r=0,o=0;M>r;++r)P[n=Y[r]]&&(r!==o&&(R[o]=R[r]),Y[o]=t[n],++o);for(R.length=o;M>o;)Y[o++]=0;var e=$(R);rn=e[0],on=e[1]}function f(t){var n=t[0],r=t[1];if(B)return B=null,q(function(t,o){return o>=n&&r>o}),rn=n,on=r,X;var o,e,a,i=[],s=[];if(rn>n)for(o=n,e=Math.min(rn,r);e>o;++o)P[a=Y[o]]^=K,i.push(a);else if(n>rn)for(o=rn,e=Math.min(n,on);e>o;++o)P[a=Y[o]]^=K,s.push(a);if(r>on)for(o=Math.max(n,on),e=r;e>o;++o)P[a=Y[o]]^=K,i.push(a);else if(on>r)for(o=Math.max(rn,r),e=on;e>o;++o)P[a=Y[o]]^=K,s.push(a);return rn=n,on=r,A.forEach(function(t){t(K,i,s)}),X}function c(t){return null==t?F():Array.isArray(t)?U(t):"function"==typeof t?G(t):L(t)}function L(t){return f(($=l(T,t))(R))}function U(t){return f(($=p(T,t))(R))}function F(){return f(($=m)(R))}function G(t){return $=m,q(B=t),rn=0,on=M,X}function q(t){var n,r,o,e=[],a=[];for(n=0;M>n;++n)!(P[r=Y[n]]&K)^!!(o=t(R[n],n))&&(o?(P[r]&=Q,e.push(r)):(P[r]|=K,a.push(r)));A.forEach(function(t){t(K,e,a)})}function z(t){for(var n,r=[],o=on;--o>=rn&&t>0;)P[n=Y[o]]||(r.push(x[n]),--t);return r}function J(t){for(var n,r=[],o=rn;on>o&&t>0;)P[n=Y[o]]||(r.push(x[n]),--t),o++;return r}function I(t){function r(n,r,o,e){function a(){++H===D&&(y=C(y,N<<=1),F=C(F,N),D=b(N))}var c,l,p,m,v,g,h=U,y=w(H,D),k=z,O=I,T=H,j=0,E=0;for(X&&(k=O=d),U=new Array(H),H=0,F=T>1?W(F,M):w(M,D),T&&(p=(l=h[0]).key);e>E&&!((m=t(n[E]))>=m);)++E;for(;e>E;){for(l&&m>=p?(v=l,g=p,y[j]=H,(l=h[++j])&&(p=l.key)):(v={key:m,value:O()},g=m),U[H]=v;!(m>g||(F[c=r[E]+o]=H,P[c]&Q||(v.value=k(v.value,x[c])),++E>=e));)m=t(n[E]);a()}for(;T>j;)U[y[j]=H]=h[j++],a();if(H>j)for(j=0;o>j;++j)F[j]=y[F[j]];c=A.indexOf(Z),H>1?(Z=i,B=u):(!H&&V&&(H=1,U=[{key:null,value:O()}]),1===H?(Z=s,B=f):(Z=d,B=d),F=null),A[c]=Z}function o(){if(H>1){for(var t=H,n=U,r=w(t,t),o=0,e=0;M>o;++o)P[o]&&(r[F[e]=F[o]]=1,++e);for(U=[],H=0,o=0;t>o;++o)r[o]&&(r[o]=H++,U.push(n[o]));if(H>1)for(var o=0;e>o;++o)F[o]=r[F[o]];else F=null;A[A.indexOf(Z)]=H>1?(B=u,Z=i):1===H?(B=f,Z=s):B=Z=d}else if(1===H){if(V)return;for(var o=0;M>o;++o)if(P[o])return;U=[],H=0,A[A.indexOf(Z)]=Z=B=d}}function i(t,n,r){if(t!==K&&!X){var o,e,a,i;for(o=0,a=n.length;a>o;++o)P[e=n[o]]&Q||(i=U[F[e]],i.value=z(i.value,x[e]));for(o=0,a=r.length;a>o;++o)(P[e=r[o]]&Q)===t&&(i=U[F[e]],i.value=J(i.value,x[e]))}}function s(t,n,r){if(t!==K&&!X){var o,e,a,i=U[0];for(o=0,a=n.length;a>o;++o)P[e=n[o]]&Q||(i.value=z(i.value,x[e]));for(o=0,a=r.length;a>o;++o)(P[e=r[o]]&Q)===t&&(i.value=J(i.value,x[e]))}}function u(){var t,n;for(t=0;H>t;++t)U[t].value=I();for(t=0;M>t;++t)P[t]&Q||(n=U[F[t]],n.value=z(n.value,x[t]))}function f(){var t,n=U[0];for(n.value=I(),t=0;M>t;++t)P[t]&Q||(n.value=z(n.value,x[t]))}function c(){return X&&(B(),X=!1),U}function l(t){var n=G(c(),0,U.length,t);return q.sort(n,0,n.length)}function p(t,n,r){return z=t,J=n,I=r,X=!0,S}function m(){return p(g,h,v)}function O(t){return p(y(t),k(t),v)}function T(t){function n(n){return t(n.value)}return G=a(n),q=e(n),S}function j(){return T(n)}function E(){return H}function L(){var t=A.indexOf(Z);return t>=0&&A.splice(t,1),t=tn.indexOf(r),t>=0&&tn.splice(t,1),t=_.indexOf(o),t>=0&&_.splice(t,1),S}var S={top:l,all:c,reduce:p,reduceCount:m,reduceSum:O,order:T,orderNatural:j,size:E,dispose:L,remove:L};nn.push(S);var U,F,G,q,z,J,I,N=8,D=b(N),H=0,Z=d,B=d,X=!0,V=t===d;return arguments.length<1&&(t=n),A.push(Z),tn.push(r),_.push(o),r(R,Y,0,M),m().orderNatural()}function N(){var t=I(d),n=t.all;return delete t.all,delete t.top,delete t.order,delete t.orderNatural,delete t.size,t.value=function(){return n()[0].value},t}function D(){nn.forEach(function(t){t.dispose()});var t=S.indexOf(o);return t>=0&&S.splice(t,1),t=S.indexOf(i),t>=0&&S.splice(t,1),t=_.indexOf(u),t>=0&&_.splice(t,1),j&=Q,F()}var R,Y,H,Z,B,X={filter:c,filterExact:L,filterRange:U,filterFunction:G,filterAll:F,top:z,bottom:J,group:I,groupAll:N,dispose:D,remove:D},K=~j&-~j,Q=~K,V=s(function(t){return H[t]}),$=m,tn=[],nn=[],rn=0,on=0;return S.unshift(o),S.push(i),_.push(u),j|=K,(E>=32?!K:j&(1<<E)-1)&&(P=C(P,E<<=1)),o(x,0,M),i(x,0,M),X}function u(){function t(t,n){var r;if(!m)for(r=n;M>r;++r)P[r]||(u=f(u,x[r]))}function n(t,n,r){var o,e,a;if(!m){for(o=0,a=n.length;a>o;++o)P[e=n[o]]||(u=f(u,x[e]));for(o=0,a=r.length;a>o;++o)P[e=r[o]]===t&&(u=c(u,x[e]))}}function r(){var t;for(u=l(),t=0;M>t;++t)P[t]||(u=f(u,x[t]))}function o(t,n,r){return f=t,c=n,l=r,m=!0,p}function e(){return o(g,h,v)}function a(t){return o(y(t),k(t),v)}function i(){return m&&(r(),m=!1),u}function s(){var r=A.indexOf(n);return r>=0&&A.splice(r),r=S.indexOf(t),r>=0&&S.splice(r),p}var u,f,c,l,p={reduce:o,reduceCount:e,reduceSum:a,value:i,dispose:s,remove:s},m=!0;return A.push(n),S.push(t),t(x,0,M),e()}function f(){return M}var c={add:t,remove:o,dimension:i,groupAll:u,size:f},x=[],M=0,j=0,E=8,P=L(0),A=[],S=[],_=[];return arguments.length?t(arguments[0]):c}function w(t,n){return(257>n?L:65537>n?S:_)(t)}function O(t){for(var n=w(t,t),r=-1;++r<t;)n[r]=r;return n}function b(t){return 8===t?256:16===t?65536:4294967296}x.version="1.3.11",x.permute=r;var T=x.bisect=o(n);T.by=o;var M=x.heap=e(n);M.by=e;var j=x.heapselect=a(n);j.by=a;var E=x.insertionsort=i(n);E.by=i;var P=x.quicksort=s(n);P.by=s;var A=32,L=u,S=u,_=u,W=f,C=c;"undefined"!=typeof Uint8Array&&(L=function(t){return new Uint8Array(t)},S=function(t){return new Uint16Array(t)},_=function(t){return new Uint32Array(t)},W=function(t,n){if(t.length>=n)return t;var r=new t.constructor(n);return r.set(t),r},C=function(t,n){var r;switch(n){case 16:r=S(t.length);break;case 32:r=_(t.length);break;default:throw new Error("invalid array width!")}return r.set(t),r}),t.crossfilter=x}("undefined"!=typeof r&&r||this)},{}],23:[function(t,n){n.exports=t("./crossfilter").crossfilter},{"./crossfilter":22}],24:[function(t,r){!function(){function t(t,n){function r(n){var r,o=t.arcs[0>n?~n:n],e=o[0];return t.transform?(r=[0,0],o.forEach(function(t){r[0]+=t[0],r[1]+=t[1]})):r=o[o.length-1],0>n?[r,e]:[e,r]}function o(t,n){for(var r in t){var o=t[r];delete n[o.start],delete o.start,delete o.end,o.forEach(function(t){e[0>t?~t:t]=1}),s.push(o)}}var e={},a={},i={},s=[],u=-1;return n.forEach(function(r,o){var e,a=t.arcs[0>r?~r:r];a.length<3&&!a[1][0]&&!a[1][1]&&(e=n[++u],n[u]=r,n[o]=e)}),n.forEach(function(t){var n,o,e=r(t),s=e[0],u=e[1];if(n=i[s])if(delete i[n.end],n.push(t),n.end=u,o=a[u]){delete a[o.start];var f=o===n?n:n.concat(o);a[f.start=n.start]=i[f.end=o.end]=f}else a[n.start]=i[n.end]=n;else if(n=a[u])if(delete a[n.start],n.unshift(t),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);a[c.start=o.start]=i[c.end=n.end]=c}else a[n.start]=i[n.end]=n;else n=[t],a[n.start=s]=i[n.end=u]=n}),o(i,a),o(a,i),n.forEach(function(t){e[0>t?~t:t]||s.push([t])}),s}function o(n,r,o){function e(t){var n=0>t?~t:t;(c[n]||(c[n]=[])).push({i:t,g:f})}function a(t){t.forEach(e)}function i(t){t.forEach(a)}function s(t){"GeometryCollection"===t.type?t.geometries.forEach(s):t.type in l&&(f=t,l[t.type](t.arcs))}var u=[];if(arguments.length>1){var f,c=[],l={LineString:a,MultiLineString:i,Polygon:i,MultiPolygon:function(t){t.forEach(i)}};s(r),c.forEach(arguments.length<3?function(t){u.push(t[0].i)}:function(t){o(t[0].g,t[t.length-1].g)&&u.push(t[0].i)})}else for(var p=0,m=n.arcs.length;m>p;++p)u.push(p);return{type:"MultiLineString",arcs:t(n,u)}}function e(r,o){function e(t){t.forEach(function(n){n.forEach(function(n){(i[n=0>n?~n:n]||(i[n]=[])).push(t)})}),u.push(t)}function a(t){return p(s(r,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var i={},u=[],f=[];return o.forEach(function(t){"Polygon"===t.type?e(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(e)}),u.forEach(function(t){if(!t._){var n=[],r=[t];for(t._=1,f.push(n);t=r.pop();)n.push(t),t.forEach(function(t){t.forEach(function(t){i[0>t?~t:t].forEach(function(t){t._||(t._=1,r.push(t))})})})}}),u.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:f.map(function(o){var e=[];if(o.forEach(function(t){t.forEach(function(t){t.forEach(function(t){i[0>t?~t:t].length<2&&e.push(t)})})}),e=t(r,e),(n=e.length)>1)for(var s,u=a(o[0][0]),f=0;f<n;++f)if(u===a(e[f])){s=e[0],e[0]=e[f],e[f]=s;break}return e})}}function a(t,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return i(t,n)})}:i(t,n)}function i(t,n){var r={type:"Feature",id:n.id,properties:n.properties||{},geometry:s(t,n)};return null==n.id&&delete r.id,r}function s(t,n){function r(t,n){n.length&&n.pop();for(var r,o=c[0>t?~t:t],e=0,a=o.length;a>e;++e)n.push(r=o[e].slice()),f(r,e);0>t&&u(n,a)}function o(t){return t=t.slice(),f(t,0),t}function e(t){for(var n=[],o=0,e=t.length;e>o;++o)r(t[o],n);return n.length<2&&n.push(n[0].slice()),n}function a(t){for(var n=e(t);n.length<4;)n.push(n[0].slice());return n}function i(t){return t.map(a)}function s(t){var n=t.type;return"GeometryCollection"===n?{type:n,geometries:t.geometries.map(s)}:n in l?{type:n,coordinates:l[n](t)}:null}var f=g(t.transform),c=t.arcs,l={Point:function(t){return o(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(o)},LineString:function(t){return e(t.arcs)},MultiLineString:function(t){return t.arcs.map(e)},Polygon:function(t){return i(t.arcs)},MultiPolygon:function(t){return t.arcs.map(i)}};return s(n)}function u(t,n){for(var r,o=t.length,e=o-n;e<--o;)r=t[e],t[e++]=t[o],t[o]=r}function f(t,n){for(var r=0,o=t.length;o>r;){var e=r+o>>>1;t[e]<n?r=e+1:o=e}return r}function c(t){function n(t,n){t.forEach(function(t){0>t&&(t=~t);var r=e[t];r?r.push(n):e[t]=[n]})}function r(t,r){t.forEach(function(t){n(t,r)})}function o(t,n){"GeometryCollection"===t.type?t.geometries.forEach(function(t){o(t,n)}):t.type in i&&i[t.type](t.arcs,n)}var e={},a=t.map(function(){return[]}),i={LineString:n,MultiLineString:r,Polygon:r,MultiPolygon:function(t,n){t.forEach(function(t){r(t,n)})}};t.forEach(o);for(var s in e)for(var u=e[s],c=u.length,l=0;c>l;++l)for(var p=l+1;c>p;++p){var m,d=u[l],v=u[p];(m=a[d])[s=f(m,v)]!==v&&m.splice(s,0,v),(m=a[v])[s=f(m,d)]!==d&&m.splice(s,0,d)}return a}function l(t,n){function r(t){a.remove(t),t[1][2]=n(t),a.push(t)}var o=g(t.transform),e=h(t.transform),a=v();return n||(n=m),t.arcs.forEach(function(t){for(var i,s,u=[],f=0,c=0,l=t.length;l>c;++c)s=t[c],o(t[c]=[s[0],s[1],1/0],c);for(var c=1,l=t.length-1;l>c;++c)i=t.slice(c-1,c+2),i[1][2]=n(i),u.push(i),a.push(i);for(var c=0,l=u.length;l>c;++c)i=u[c],i.previous=u[c-1],i.next=u[c+1];for(;i=a.pop();){var p=i.previous,m=i.next;i[1][2]<f?i[1][2]=f:f=i[1][2],p&&(p.next=m,p[2]=i[2],r(p)),m&&(m.previous=p,m[0]=i[0],r(m))}t.forEach(e)}),t}function p(t){for(var n,r=-1,o=t.length,e=t[o-1],a=0;++r<o;)n=e,e=t[r],a+=n[0]*e[1]-n[1]*e[0];return.5*a}function m(t){var n=t[0],r=t[1],o=t[2];return Math.abs((n[0]-o[0])*(r[1]-n[1])-(n[0]-r[0])*(o[1]-n[1]))}function d(t,n){return t[1][2]-n[1][2]}function v(){function t(t,n){for(;n>0;){var r=(n+1>>1)-1,e=o[r];if(d(t,e)>=0)break;o[e._=n]=e,o[t._=n=r]=t}}function n(t,n){for(;;){var r=n+1<<1,a=r-1,i=n,s=o[i];if(e>a&&d(o[a],s)<0&&(s=o[i=a]),e>r&&d(o[r],s)<0&&(s=o[i=r]),i===n)break;o[s._=n]=s,o[t._=n=i]=t}}var r={},o=[],e=0;return r.push=function(n){return t(o[n._=e]=n,e++),e},r.pop=function(){if(!(0>=e)){var t,r=o[0];return--e>0&&(t=o[e],n(o[t._=0]=t,0)),r}},r.remove=function(r){var a,i=r._;if(o[i]===r)return i!==--e&&(a=o[e],(d(a,r)<0?t:n)(o[a._=i]=a,i)),i},r}function g(t){if(!t)return y;var n,r,o=t.scale[0],e=t.scale[1],a=t.translate[0],i=t.translate[1];return function(t,s){s||(n=r=0),t[0]=(n+=t[0])*o+a,t[1]=(r+=t[1])*e+i}}function h(t){if(!t)return y;var n,r,o=t.scale[0],e=t.scale[1],a=t.translate[0],i=t.translate[1];return function(t,s){s||(n=r=0);var u=(t[0]-a)/o|0,f=(t[1]-i)/e|0;t[0]=u-n,t[1]=f-r,n=u,r=f}}function y(){}var k={version:"1.6.18",mesh:function(t){return s(t,o.apply(this,arguments))},meshArcs:o,merge:function(t){return s(t,e.apply(this,arguments))},mergeArcs:e,feature:a,neighbors:c,presimplify:l};"function"==typeof define&&define.amd?define(k):"object"==typeof r&&r.exports?r.exports=k:this.topojson=k}()},{}]},{},[1]);